<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wzmtr.dom.mapper.traffic.HotLineHandoverMapper">


    <select id="list" resultType="com.wzmtr.dom.dto.res.traffic.hotline.HotLineHandoverListResDTO">
        SELECT *
        FROM TRAFFIC_HOTLINE_HANDOVER
        WHERE DEL_FLAG='0'
        AND DATA_TYPE = #{req.dataType}
        <if test="req.startDate != null and req.startDate!=''">
            AND START_DATE >= to_date(#{req.startDate},'yyyy-mm-dd hh24:mi:ss')
        </if>
        <if test="req.endDate != null and req.endDate!=''">
            AND to_date(#{req.endDate},'yyyy-mm-dd hh24:mi:ss')>=END_DATE
        </if>
        ORDER BY CREATE_DATE desc
    </select>
    <select id="selectIsExist" resultType="java.lang.Integer">
        select count(1) from TRAFFIC_HOTLINE_HANDOVER
        WHERE
        <if test="dataType=='1'.toString()">
            DATA_DATE=#{dataDate,jdbcType=TIMESTAMP}
        </if>
        <if test="dataType!='1'.toString()">
            START_DATE=#{startDate,jdbcType=TIMESTAMP} and END_DATE=#{endDate,jdbcType=TIMESTAMP}
        </if>
        <if test="version!=null and version!=''">
            AND VERSION=#{version,jdbcType=VARCHAR}
        </if>
        AND DEL_FLAG='0' AND rownum=1
    </select>
</mapper>